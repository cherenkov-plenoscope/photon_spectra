import numpy as np
from . import utils


def init(key="blue"):
    _sony2019ccd = "{Sony CCD RGB sensor quantum-efficiency.}"
    _ccd = {}
    _ccd["blue"] = np.array(
        [
            [2e-7, 0.0],  # extrapolated
            [3.7018891099466383e-7, 0.005735486401673429],
            [3.769712954605501e-7, 0.02909138455686544],
            [3.802882601678166e-7, 0.04754559843646744],
            [3.840626462074657e-7, 0.0714346040601268],
            [3.8746899335776397e-7, 0.09748281838929396],
            [3.9325084338993717e-7, 0.12580146830931338],
            [3.984243925558337e-7, 0.14548441616302477],
            [4.020651661493512e-7, 0.18535543683408862],
            [4.054857094987193e-7, 0.20624125043584363],
            [4.0731788967028517e-7, 0.22987651092515093],
            [4.0915256111346976e-7, 0.2497383946684416],
            [4.1288361914842e-7, 0.27238369197051193],
            [4.176538118562499e-7, 0.294367242407772],
            [4.233552623283692e-7, 0.3221901333755258],
            [4.2734680160443256e-7, 0.34039897864722224],
            [4.308567274540415e-7, 0.356399764229262],
            [4.358985393358154e-7, 0.3777012726638772],
            [4.404365127483119e-7, 0.39841169368898177],
            [4.462416689806258e-7, 0.4158221345691925],
            [4.555501810749692e-7, 0.42999369064222615],
            [4.689802432828718e-7, 0.43444606329282043],
            [4.810877463486442e-7, 0.4248260726884895],
            [4.893257717081436e-7, 0.4037956473733145],
            [4.938017433037245e-7, 0.3850135460251043],
            [4.971957139784235e-7, 0.36750063197350047],
            [5.001610330505677e-7, 0.3424441421617461],
            [5.036053453601611e-7, 0.32402272925383524],
            [5.072933031738666e-7, 0.29996099481062855],
            [5.096762669994958e-7, 0.27449507496513237],
            [5.135179445240063e-7, 0.2571425288449346],
            [5.161724766999549e-7, 0.23034237951340442],
            [5.183978153399507e-7, 0.2047360495802225],
            [5.207748453072088e-7, 0.18886097454672235],
            [5.234293855253499e-7, 0.16556268679019703],
            [5.257185064943264e-7, 0.1464456126767304],
            [5.289563053497801e-7, 0.12431734409244843],
            [5.332095837313352e-7, 0.09866129541077195],
            [5.371237284493283e-7, 0.07795676429567622],
            [5.425273161414878e-7, 0.05846349151003949],
            [5.482261024404573e-7, 0.04250416472958296],
            [5.548799458633671e-7, 0.025534901402448407],
            [5.653772369609933e-7, 0.011810080029222236],
            [5.787729954572746e-7, 0.005500888291160022],
            [5.921858830796344e-7, 0.004565348105769251],
            [6.056018781089191e-7, 0.004604645864234369],
            [6.190162133626586e-7, 0.004123248323038897],
            [6.324285827471275e-7, 0.003025129507869817],
            [6.477613235498971e-7, 0.003124958491067087],
            [6.612705165923908e-7, 0.0023393043933053193],
            [6.742722024504742e-7, 0.002674729776847684],
            [6.880157426672391e-7, 0.005261298731486841],
            [7.014359583552145e-7, 0.0066246774162939115],
            [7.148488474928897e-7, 0.005689612607014061],
            [7.282618517945409e-7, 0.0047906763821286],
            [7.416753849412911e-7, 0.004057646419795002],
            [7.550914638180321e-7, 0.004123248323038897],
            [7.685092883381948e-7, 0.0047364835055361265],
            [7.819504426553414e-7, 0.012668609284717913],
            [7.924668011741671e-7, 0.03225505578800547],
            [7.991615528134983e-7, 0.050893905567386266],
            [8.06738836094101e-7, 0.07310008426313308],
            [8.150982337529503e-7, 0.09014588314405225],
            [8.250301241472537e-7, 0.09946345065222739],
            [8.511104744500706e-7, 0.08237828071510056],
            [8.671103932258389e-7, 0.07314500730557216],
            [8.805058738132631e-7, 0.06674863158885125],
            [8.939040995461935e-7, 0.06121344723384459],
            [9.072899487884868e-7, 0.051795580959022036],
            [9.206790968725595e-7, 0.04341260847667727],
            [9.340694478140526e-7, 0.03540698955081778],
            [9.474633206517624e-7, 0.028506239780895948],
            [9.608653264906652e-7, 0.024156928671049904],
            [9.742643986788175e-7, 0.018887289411347874],
            [9.876688593287827e-7, 0.015308087600451437],
            [0.0000010010752645830914, 0.012338935952111996],
            [0.0000010144810921991425, 0.009188570930464213],
            [0.0000010269354128733587, 0.00816188529882722],
            [0.0000010437927489013614, 0.006603840930778704],
            [0.000001056631302196412, 0.004811592930989317],
            [0.000001070047523512807, 0.00492188018861639],
            [0.0000010818632906013237, 0.0039884791957225385],
            [12e-7, 0.0],  # extrapolated
        ]
    )

    _ccd["green"] = np.array(
        [
            [2e-7, 0.0],  # extrapolated
            [3.5934682198424673e-7, 0.011500610181310877],
            [3.8457198313530626e-7, 0.008535689380354539],
            [3.979862299956433e-7, 0.008026561566048862],
            [4.114154966629238e-7, 0.012229361758650414],
            [4.248434586435843e-7, 0.016022863120143338],
            [4.3827893052771663e-7, 0.022172328485089654],
            [4.51718411936584e-7, 0.02957963903832095],
            [4.623131991892406e-7, 0.04644075430032535],
            [4.6875338691909736e-7, 0.06265298117154794],
            [4.738835738174898e-7, 0.07986682550751567],
            [4.784540501558559e-7, 0.09963961944610467],
            [4.864940151119652e-7, 0.1166831494864966],
            [4.93895302699469e-7, 0.13378113169954164],
            [4.978880415273132e-7, 0.15045756334263105],
            [5.015734703402198e-7, 0.17511013371228767],
            [5.040602752648619e-7, 0.19951851713488755],
            [5.075249565029484e-7, 0.2208899058577405],
            [5.086052227046672e-7, 0.23911817904463029],
            [5.159210821196769e-7, 0.2942568094183279],
            [5.185102266697344e-7, 0.3151573396094838],
            [5.214061141342316e-7, 0.3401351348210133],
            [5.246406486280528e-7, 0.35945203539051584],
            [5.268108555286731e-7, 0.378901943070876],
            [5.29556760318304e-7, 0.3985815027894002],
            [5.398343368855e-7, 0.41613742777445695],
            [5.503275874527055e-7, 0.40114503428637827],
            [5.546878402738459e-7, 0.3828033558262912],
            [5.582539778029475e-7, 0.36433889100207084],
            [5.624611531033869e-7, 0.3457429155572459],
            [5.647878527357653e-7, 0.3279534954672244],
            [5.684674118101586e-7, 0.30711328768860136],
            [5.71692321154794e-7, 0.2894005404463038],
            [5.745091793446402e-7, 0.2712141954323568],
            [5.779493181545373e-7, 0.24814321827057184],
            [5.815725920067042e-7, 0.2223993200836818],
            [5.845602559502602e-7, 0.20101245786843314],
            [5.870006674999301e-7, 0.18163914624427158],
            [5.901263116000501e-7, 0.16011501917712667],
            [5.942800322095709e-7, 0.14044651324965107],
            [5.964018689964363e-7, 0.12468035857680182],
            [5.994630913741353e-7, 0.10298788354253818],
            [6.01463619718441e-7, 0.08702201894239758],
            [6.047451167467276e-7, 0.06985414487447672],
            [6.08623079746871e-7, 0.05052375971309009],
            [6.13996682982626e-7, 0.03275819386331902],
            [6.254434178695638e-7, 0.01626245267981652],
            [6.353324333039913e-7, 0.012129532775453145],
            [6.842171316619797e-7, 0.016082760510061522],
            [6.976674324233065e-7, 0.026884256491996883],
            [7.111130872274006e-7, 0.03622824931925317],
            [7.245316300070964e-7, 0.03706681277810975],
            [7.379562188955194e-7, 0.039802126917712455],
            [7.514021919158626e-7, 0.04924594872816623],
            [7.648476557902072e-7, 0.058530044165504114],
            [7.782935651673007e-7, 0.06795390017931857],
            [7.917391563281451e-7, 0.07727792720993532],
            [8.01983104380742e-7, 0.08428410675795583],
            [8.115653413204685e-7, 0.08849372384937237],
            [8.281516031430292e-7, 0.09184100418410024],
            [8.472612814474396e-7, 0.08682008368200833],
            [8.625351533026956e-7, 0.07845188284518811],
            [8.383519674417542e-7, 0.09184100418410024],
            [8.205013299189855e-7, 0.09184100418410024],
            [8.727141779271555e-7, 0.07175732217573216],
            [8.867130042450711e-7, 0.06338912133891217],
            [9.032565867191013e-7, 0.05334728033472791],
            [9.299845287361578e-7, 0.03828451882845174],
            [9.503532478222102e-7, 0.028242677824267703],
            [9.720023473641692e-7, 0.01987447698744771],
            [9.911120256685796e-7, 0.014853556485355579],
            [0.0000010127717950476714, 0.009832635983263449],
            [0.0000010382673708759175, 0.008158995815899628],
            [0.000001079063493152251, 0.0064853556485355845],
            [0.000001098183841293794, 0.004811715481171541],
            [3.012803804559068e-7, 0.004811715481171541],
            [3.2040606351601613e-7, 0.004811715481171541],
            [3.4463192872548794e-7, 0.004811715481171541],
            [3.727149400583792e-7, 0.014853556485355579],
            [6.481034364496878e-7, 0.008158995815899628],
            [6.697792105844782e-7, 0.008158995815899628],
            [12e-7, 0.0],  # extrapolated
        ]
    )

    _ccd["red"] = np.array(
        [
            [2e-7, 0.0],  # extrapolated
            [3.6671814227973774e-7, 0.019197424785813544],
            [3.8971064095024217e-7, 0.017272721989772144],
            [4.3760615773448873e-7, 0.01153055887626997],
            [4.510198636272028e-7, 0.010851721790529067],
            [4.6444680731586713e-7, 0.014325770405791305],
            [4.778796061835095e-7, 0.019636672311881265],
            [4.913043860016819e-7, 0.022431883841402822],
            [5.04726556446614e-7, 0.024408497708706678],
            [5.18137843895837e-7, 0.022970960350667147],
            [5.315521862210486e-7, 0.022491781231320784],
            [5.440094931779731e-7, 0.022401935146443286],
            [5.70515411087231e-7, 0.020395372584179894],
            [5.803710832445336e-7, 0.03313173576771877],
            [5.835331594936297e-7, 0.049665682172450376],
            [5.873520056925642e-7, 0.06917377120536705],
            [5.899837575744729e-7, 0.09997711820083666],
            [5.889181749719917e-7, 0.08173029986052982],
            [5.981049762458518e-7, 0.1779694328219431],
            [5.9950073286223e-7, 0.20164377831560343],
            [6.033244647161065e-7, 0.25047739117293855],
            [6.016978668105826e-7, 0.22286052998605277],
            [6.057726374480569e-7, 0.2768106536072016],
            [6.085706576603784e-7, 0.301300424515653],
            [6.14301436562667e-7, 0.32878041221137433],
            [6.213848768290825e-7, 0.34637348245641697],
            [6.334838065467745e-7, 0.3340639100828614],
            [6.436554270239772e-7, 0.3183798959786145],
            [6.534975213278744e-7, 0.2995271471250157],
            [6.633403495862993e-7, 0.28090465029185374],
            [6.728723659898094e-7, 0.2649843677359366],
            [6.843208224266533e-7, 0.24902870135153043],
            [6.976939610512488e-7, 0.23562333272453562],
            [7.11082283894516e-7, 0.22698147041243266],
            [7.244642954488489e-7, 0.2163596666002522],
            [7.378422338351969e-7, 0.20446005180314786],
            [7.499377772339121e-7, 0.19108814279061015],
            [7.620257777390363e-7, 0.17534992030284902],
            [7.750788714321146e-7, 0.1617502179218966],
            [7.881273700825602e-7, 0.14670898502357688],
            [8.014980213168104e-7, 0.1325232865112571],
            [8.148793327953959e-7, 0.12168185893604277],
            [8.282571438952444e-7, 0.10974231254565958],
            [8.377120805446742e-7, 0.10304378777312873],
            [8.51520493917002e-7, 0.0925792146094837],
            [8.638155337586025e-7, 0.08012552301255216],
            [8.803484463955003e-7, 0.06673640167364003],
            [9.045316322564419e-7, 0.05334728033472791],
            [9.299845287361578e-7, 0.03828451882845174],
            [9.554480950530063e-7, 0.02656903765690366],
            [9.758221490576247e-7, 0.018200836820083666],
            [0.0000010013070550487384, 0.013179916317991536],
            [0.0000010255169155025112, 0.008158995815899628],
            [0.000001052282201949532, 0.004811715481171541],
            [0.0000010816135842269325, 0.0064853556485355845],
            [0.0000010969087957564534, 0.004811715481171541],
            [5.937246115036087e-7, 0.14874476987447693],
            [4.147647681977883e-7, 0.0064853556485355845],
            [4.020249826615148e-7, 0.009832635983263449],
            [3.5356791732400484e-7, 0.008158995815899628],
            [3.395264116575592e-7, 0.003138075313807276],
            [3.012803804559068e-7, 0.004811715481171541],
            [12e-7, 0.0],  # extrapolated
        ]
    )

    order = np.argsort(_ccd[key][:, 0])
    _ccd[key] = _ccd[key][order]

    assert utils.is_strictly_monotonic_increasing(_ccd[key][:, 0])

    return {
        "wavelength": _ccd[key][:, 0],
        "value": _ccd[key][:, 1],
        "units": ["m", "1"],
        "reference": "{" + key + "}" + _sony2019ccd,
    }
