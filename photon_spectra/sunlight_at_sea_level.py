import numpy as np
from . import utils


def init():
    _wikimedia2019solar = "".join(
        [
            "https://commons.wikimedia.org/wiki/File:Solar_Spectrum.png"
            "This figure shows the solar radiation spectrum for direct light at both"
            "the top of the Earth's atmosphere and at sea level. The sun produces"
            "light with a distribution similar to what would be expected from"
            "a 5525 K (5250 Â°C) blackbody, which is approximately the sun's surface"
            "temperature. As light passes through the atmosphere, some is absorbed by"
            "gases with specific absorption bands. Additional light is redistributed "
            "by Rayleigh scattering, which is responsible for the atmosphere's blue "
            "color. These curves are based on NREL data for above the atmosphere and "
            "at sea level, which are standards adopted by the photovoltaics industry "
            "to ensure consistent test conditions and are similar to the light that "
            "could be expected in North America. Regions for ultraviolet, visible and"
            "infrared light are indicated."
        ]
    )

    _sunlight_differential_flux_at_sea_level = np.array(
        [
            # wavelength/m, differential flux/W m$^{-2} (nm)$^{-1}$
            [2.0e-7, 0.0],
            [3.0234225983975686e-7, 0.014288610003807545],
            [3.067638023052429e-7, 0.048065113833127615],
            [3.1045170776073816e-7, 0.07965669785876361],
            [3.1340578658695843e-7, 0.108864641071031],
            [3.163632785602917e-7, 0.14164956245762417],
            [3.1932759682785083e-7, 0.18158844019286846],
            [3.2448258668404355e-7, 0.21735114281618806],
            [3.303577505810595e-7, 0.24118957355557358],
            [3.3711555432147305e-7, 0.2700345601755969],
            [3.4622183081870695e-7, 0.3067456626100227],
            [3.531240106819963e-7, 0.3335634926706921],
            [3.553454005946461e-7, 0.361580121127699],
            [3.575741856593739e-7, 0.397346868962412],
            [3.678326837361398e-7, 0.4149195200796374],
            [3.773363074431011e-7, 0.40805049830848583],
            [3.940789317476104e-7, 0.5765429916566043],
            [3.9970880413877896e-7, 0.8544270353788912],
            [4.065981657384667e-7, 0.9189224362959814],
            [4.0559463728084416e-7, 0.8894468349298723],
            [4.201781300043004e-7, 0.8396138757785927],
            [4.2613520943202605e-7, 0.9492997827017966],
            [4.2838333566372687e-7, 1.005336073524355],
            [4.313465162155817e-7, 1.0440826252014908],
            [4.343136787724016e-7, 1.0870023180820068],
            [4.3654189497927714e-7, 1.122172902887665],
            [4.387729554754135e-7, 1.160324302838595],
            [4.417412557479377e-7, 1.2044363217772194],
            [4.4470102315267955e-7, 1.2396058952800295],
            [4.4838361926822134e-7, 1.265633291034492],
            [4.582352079056497e-7, 1.294860087821288],
            [4.689201462080102e-7, 1.3212468572664744],
            [4.786074161915743e-7, 1.2512835778194606],
            [4.90570420974597e-7, 1.3174014793162183],
            [5.011159836854866e-7, 1.3291512003285413],
            [5.115651439523651e-7, 1.2909822711282415],
            [5.088490373276279e-7, 1.255613639514797],
            [5.435713621457913e-7, 1.3557211600610999],
            [5.587532680471391e-7, 1.3196918780069766],
            [5.716221979216408e-7, 1.3129970531514392],
            [5.844615885593109e-7, 1.2753451080962825],
            [6.040849814272034e-7, 1.2939941669810497],
            [6.385656933536299e-7, 1.2431135992092488],
            [6.472909867853497e-7, 1.187221115651714],
            [6.63125815088111e-7, 1.2561952510195347],
            [6.707270201214092e-7, 1.2148507185086885],
            [6.721457516046739e-7, 1.1683479796367573],
            [6.786042792290708e-7, 1.0368849300046517],
            [7.028307026268373e-7, 1.1261766508639603],
            [7.02762060446011e-7, 1.0542396453580756],
            [7.224504203282426e-7, 0.9876408019367766],
            [7.254249780371404e-7, 1.038310614194998],
            [7.324153877532985e-7, 1.0809266633953216],
            [7.361668346308789e-7, 1.1024429910996552],
            [7.437126202680921e-7, 1.0370930055656828],
            [7.451074597215664e-7, 0.9655514194734716],
            [7.450824299760718e-7, 0.9393202461950825],
            [7.450574002305772e-7, 0.9130890729166938],
            [7.463623601434116e-7, 0.7473537282339047],
            [7.477037269587838e-7, 0.6197728174105896],
            [7.490485069212689e-7, 0.4957688847616004],
            [7.526175210856644e-7, 0.4027623957148898],
            [7.564277309793722e-7, 0.5625290309871982],
            [7.580250838282123e-7, 0.7032214832383148],
            [7.580000540827177e-7, 0.6769903099599257],
            [7.611469757208171e-7, 0.9082975200215975],
            [7.611151196810968e-7, 0.8749123903945573],
            [7.675705185873069e-7, 0.9957259996582086],
            [7.700587028326154e-7, 1.0477875331861226],
            [7.831752646566992e-7, 0.9939443248259519],
            [7.93399850678936e-7, 0.9759771427968413],
            [7.984896494252724e-7, 0.943419562290539],
            [8.006285549493602e-7, 0.8849925515346739],
            [8.104177452981015e-7, 0.7940640370154428],
            [8.203289556561289e-7, 0.831012492228357],
            [8.467694370208954e-7, 0.855451777318343],
            [8.744736993106433e-7, 0.841370508826035],
            [8.788351324630852e-7, 0.8121524525852859],
            [8.809859840020684e-7, 0.7662448654395604],
            [8.824024400539245e-7, 0.7173574744514117],
            [8.838171895322243e-7, 0.6666815943761004],
            [8.928362032349381e-7, 0.6119412881535977],
            [9.10853865529259e-7, 0.6344513726017831],
            [9.144331191349933e-7, 0.5521758180780494],
            [9.158376291719541e-7, 0.49076900347976116],
            [9.158137371421637e-7, 0.46573015625948067],
            [9.172165406055683e-7, 0.4025348525740293],
            [9.171915108600738e-7, 0.37630367929564024],
            [9.185829371664351e-7, 0.30118511502910295],
            [9.25196933641825e-7, 0.17932008790420229],
            [9.38065180886904e-7, 0.27413208963602154],
            [9.456514692031903e-7, 0.3023400228818258],
            [9.500788898664818e-7, 0.34227687801137385],
            [9.523036929262444e-7, 0.3738704846427061],
            [9.537906873517671e-7, 0.39890730925729034],
            [9.552799572086986e-7, 0.4263287859880909],
            [9.567715024970388e-7, 0.45613491483510904],
            [9.582664609324915e-7, 0.489518021856453],
            [9.5976028165224e-7, 0.5217088028196879],
            [9.649132805059503e-7, 0.5553849348413173],
            [9.707932796947097e-7, 0.5842907513276643],
            [9.73750771668043e-7, 0.6170756727142575],
            [0.0000010028003195717002, 0.6498907646358241],
            [0.0000010195227178192442, 0.626815979913864],
            [0.0000010344558685024892, 0.6026838218805479],
            [0.0000010490624947785994, 0.5770948259108097],
            [0.0000010638316879875688, 0.5515056052071055],
            [0.0000010753492391485006, 0.525602925567231],
            [0.0000010811742677068137, 0.4968995213459646],
            [0.0000010855343735242673, 0.46629041803742144],
            [0.0000010891617904281506, 0.4344899999736178],
            [0.0000010920584146113035, 0.4034854772514018],
            [0.0000010949482125002308, 0.36532699818053427],
            [0.000001097111010054109, 0.3319388346449488],
            [0.0000010985479449886427, 0.30451331270275483],
            [0.000001099980329060359, 0.2723184865281265],
            [0.0000011014081622692581, 0.23535435612106426],
            [0.0000011028382709095658, 0.20077487783021875],
            [0.0000011042706549812822, 0.16858005165559042],
            [0.0000011064260573830826, 0.12744176874229973],
            [0.0000011430570899144966, 0.1834305283309896],
            [0.0000011460202704663515, 0.2221770800081253],
            [0.000001148986295307467, 0.2639044468305327],
            [0.0000011519511824328782, 0.3044394875948311],
            [0.0000011549115186954723, 0.3402052241266955],
            [0.0000011987094775345668, 0.39379942083125563],
            [0.00000121228576318629, 0.41285789494820513],
            [0.0000012300109946207485, 0.41853006789017666],
            [0.000001239835738585249, 0.4074543352794313],
            [0.0000012478530315341817, 0.376244012427593],
            [0.0000012576833692675618, 0.3284379570099554],
            [0.000001275645340378157, 0.36925034758039166],
            [0.0000012865930097428039, 0.3424078417302243],
            [0.0000012924212428670173, 0.3170628225726313],
            [0.0000012982497604201567, 0.29201588492956443],
            [0.000001304076855828666, 0.2654785397138628],
            [0.0000013099050889528794, 0.2401335205562689],
            [0.0000013142594113821697, 0.20346342645234028],
            [0.0000013186114583800512, 0.1644086802321949],
            [0.0000013237125015499318, 0.14363525560019896],
            [0.0000013273448485552, 0.11700158378819969],
            [0.0000013302386284490926, 0.083016245920712],
            [0.0000013324019948608228, 0.050224245414181024],
            [0.0000013455141683529044, -0.008217934884408251],
            [0.0000013616082947059615, -0.008240183547070234],
            [0.0000013777024210590189, -0.008262432209732218],
            [0.0000013937965474120762, -0.008284680872393757],
            [0.0000014098910099084095, -0.00795465138152407],
            [0.0000014384626971051235, 0.03517353077482488],
            [0.000001450334532936375, 0.056857481926258835],
            [0.0000014626133296750551, 0.04503646406313333],
            [0.00000147031959011236, 0.07119740235870964],
            [0.0000014765608140372353, 0.09533340896119835],
            [0.0000014809825461220054, 0.1293086338002034],
            [0.000001486137194663487, 0.16471363860608967],
            [0.0000014942048884181202, 0.1863233601284615],
            [0.0000015031576491429869, 0.21548326645543625],
            [0.0000015154661402615493, 0.23478195870894414],
            [0.0000015340071138559924, 0.24350006346291764],
            [0.0000015505794600434245, 0.2335410901141186],
            [0.0000015790947872174838, 0.21760396852825492],
            [0.0000016149304481177142, 0.20670992530303556],
            [0.0000016244342749881943, 0.20005381889940343],
            [0.00000171708334071396, 0.14865565188267515],
            [0.0000017336668148445189, 0.1357555883276298],
            [0.0000017505486386654497, 0.11790695266311202],
            [0.0000017611328647483574, 0.09350922088349156],
            [0.0000017691547464839638, 0.06710794646602336],
            [0.0000017771798896712564, 0.044124673415134374],
            [0.0000017822832272344734, 0.02575577300032439],
            [0.0000017990759110299723, -0.00884494265033453],
            [0.0000018151700373830294, -0.008867191312996514],
            [0.000001831264163736087, -0.008889439975658497],
            [0.000001847358290089144, -0.00891168863832048],
            [0.0000018634524164422012, -0.008933937300982464],
            [0.0000018795465427952587, -0.008956185963644447],
            [0.0000018956406691483158, -0.008978434626305987],
            [0.000001911734795501373, -0.00900068328896797],
            [0.0000019278289218544307, -0.009022931951629953],
            [0.000001943923048207488, -0.009045180614291937],
            [0.0000019637179741273558, 0.036037183407246154],
            [0.000001976023127946519, 0.05183838589030243],
            [0.0000019849206336120135, 0.023090989995136812],
            [0.0000020134679116354353, 0.04063835854115583],
            [0.0000020240964517450254, 0.06268172672486472],
            [0.000002039320889251786, 0.04567001158747841],
            [0.0000020592687620861686, 0.04659629757630279],
            [0.000002075914377164958, 0.0623120112585851],
            [0.0000021002229373159326, 0.06731267910930638],
            [0.0000021151754291661504, 0.06345006406383646],
            [0.0000021276123683877286, 0.0640290349444701],
            [0.000002144434063933687, 0.059832633775580124],
            [0.0000021605259148553357, 0.05742573299670095],
            [0.000002176617765776984, 0.05501883221782178],
            [0.0000021985620262815628, 0.05260384101615667],
            [0.000002219043184390409, 0.050190872420187826],
            [0.000002235970768762275, 0.0474421512785943],
            [0.0000022537340865843586, 0.04435160977428598],
            [0.0000022704523312666325, 0.0412625129883315],
            [0.0000022888417177877123, 0.03714911088891748],
            [0.000002304862596920188, 0.03337964807247129],
            [0.000002321196402048284, 0.028985200095795083],
            [0.0000023381149172006794, 0.024033524249722493],
            [0.000002350689169226802, 0.01518298096024484],
            [0.000002368341560062156, 0.014888576410965193],
            [0.0000023855171099251023, 0.014864832778875403],
            [0.0000024045921503552316, 0.005507203554158124],
            [0.000002423676094647394, 0.0054808217407251725],
            [0.0000024332091629314417, -0.0038636165772762965],
            [0.000002519086912246174, -0.003982334737725246],
            [0.000002589694538173165, -0.007190363251189158],
            [0.0000016681181061023773, 0.1807088265633201],
            [0.000001692915361866144, 0.1682328669908113],
            [3.802011745183341e-7, 0.44376452648602127],
            [3.8213924848766247e-7, 0.4748660463422931],
            [3.859293257599941e-7, 0.44686702774575293],
            [3.8981140960667363e-7, 0.5152908990658198],
            [4.2450679199786843e-7, 0.8760516450379763],
            [4.149499800817308e-7, 0.8605127569258855],
            [3.6109645454809276e-7, 0.42201799767312353],
            [3.919038171845857e-7, 0.7081340407176908],
            [3.9583932420346717e-7, 0.832545396505465],
            [4.131128165487839e-7, 0.935165374397505],
            [4.745079132249393e-7, 1.2772266910082863],
            [4.821563307118606e-7, 1.2927682173017205],
            [5.337156277948233e-7, 1.326911560246828],
            [5.203568667903094e-7, 1.326930027516231],
            [5.279993483692082e-7, 1.3362507222021425],
            [5.470743887993372e-7, 1.3268930929774247],
            [5.775641803566293e-7, 1.2801946450195092],
            [5.813572255829722e-7, 1.2553060422267304],
            [5.92852111468438e-7, 1.3019464501950933],
            [6.119182480365336e-7, 1.283257573559091],
            [6.138058667876712e-7, 1.2614820247514174],
            [6.195221462132864e-7, 1.2521428627961029],
            [6.2525920131698e-7, 1.2645766114671189],
            [6.310081282367187e-7, 1.2894520233531812],
            [6.423842959617358e-7, 1.2116757991710831],
            [6.538465343530784e-7, 1.2241016332980696],
            [6.576989386596456e-7, 1.261421346580521],
            [6.747260908220309e-7, 1.105876812760355],
            [6.861853612593623e-7, 1.11519223108358],
            [6.900496373819745e-7, 1.1649536075810776],
            [6.995886415740446e-7, 1.1618300008705997],
            [7.070530459122699e-7, 0.98452574733082],
            [7.089258248933515e-7, 0.9471981195043386],
            [7.184737329474554e-7, 0.9534057602051447],
            [7.396174373234067e-7, 1.1120079462022057],
            [7.643731417310165e-7, 1.0559861653770355],
            [8.023184337645e-7, 0.8226522164680556],
            [8.405070980269044e-7, 0.84437236346752],
            [8.519812082342916e-7, 0.8692398608095524],
            [8.291071866697974e-7, 0.8972652612195255],
            [8.329358473442748e-7, 0.9097016480718847],
            [8.386254151837888e-7, 0.8723687438827166],
            [8.252607182712526e-7, 0.8661663795445973],
            [8.672394598059882e-7, 0.859887507947521],
            [8.576915517518844e-7, 0.8536798672467145],
            [8.860829998232419e-7, 0.607917446029405],
            [8.898908848196408e-7, 0.5985809222554339],
            [9.013323475329048e-7, 0.5892338457560893],
            [9.089718611577924e-7, 0.5954441246382394],
            [9.20063105297732e-7, 0.21906798329503596],
            [9.315550232291868e-7, 0.26259797545963703],
            [9.777334196898026e-7, 0.6575574661851102],
            [9.8347937865553e-7, 0.679322462267411],
            [9.911010845563501e-7, 0.666870246326992],
            [0.000001110777894150888, 0.08816670140272098],
            [0.0000011184025680057193, 0.07882490126606312],
            [0.0000011222431004962418, 0.10370295133346863],
            [0.0000011280157710480704, 0.1534616896496228],
            [0.0000011356285730868566, 0.13167822629791903],
            [0.0000011260747291247305, 0.11924975398958937],
            [0.0000011606840408495998, 0.38980844165266193],
            [0.0000011721225356088527, 0.37735094934955615],
            [0.0000011835877419542062, 0.3928871992803038],
            [0.000001191212415809038, 0.38354539914364594],
            [0.000001252245422095824, 0.3461359876955221],
            [0.0000012656279267324276, 0.37100084685621093],
            [0.0000013339710037488557, -0.0054544399272917765],
            [0.0000014236774137380655, 0.006863228764618867],
            [0.0000014485548042601352, 0.07836849589367079],
            [0.000001454241404145638, 0.03792517590074107],
            [0.0000015612806655603892, 0.21507113855992221],
            [0.0000015956198934702372, 0.20258198808069716],
            [0.000001647134671243032, 0.190069093969381],
            [0.000001956122427443418, 0.00923759197359697],
            [0.000001996192774548937, 0.002961358557864724],
            [0.0000020076520449862686, 0.01227677688108919],
            [0.0000020344140863054647, 0.05889607939870567],
            [0.0000024484822542731945, 0.0023361095795002562],
            [0.0000024599266849404698, -0.0039005511160827844],
        ]
    )

    h = 6.626e-34  # [J s]
    c = 299792458

    _sldfasl = _sunlight_differential_flux_at_sea_level
    _sort_wvl = np.argsort(_sldfasl[:, 0])
    _sldfasl = _sldfasl[_sort_wvl]
    _mask_negative_flux = _sldfasl[:, 1] < 0
    _sldfasl[_mask_negative_flux, 1] = 0.0

    _sldfasl[:, 1] = _sldfasl[:, 1] * 1e9  # (nm)$^{-1}$ --> m$^{-1}$

    # Watt -> photons s^{-1}
    _photon_energy_J = (h * c) / (_sldfasl[:, 0])
    _flux_per_m2_per_s_per_m = _sldfasl[:, 1] / _photon_energy_J
    _sldfasl[:, 1] = _flux_per_m2_per_s_per_m

    assert utils.is_strictly_monotonic_increasing(_sldfasl[:, 0])

    return {
        "wavelength": _sldfasl[:, 0],
        "value": _sldfasl[:, 1],
        "units": ["m", "m^{-2} s^{-1} m^{-1}"],
        "reference": _wikimedia2019solar,
        "key": "sunlight_at_sea_level",
    }
